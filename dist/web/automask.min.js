!function(){var i,e,a,t,u,r;(e=i=i||{}).MASK="mask",e.PREFIX="prefix",e.SUFFIX="suffix",e.DIRECTION="dir",e.ACCEPT="accept",e.SHOW_MASK="show-mask",(t=a=a||{}).FORWARD="forward",t.BACKWARD="backward",(r=u=u||{}).UNKNOWN="unknown",r.BACKSPACE="backspace",r.INVALID="invalid",r.VALID="valid";var n,o=document;function s(e){for(var t=p.getAutoMask(e),r=t.currentValue,n=t.pattern.length,i="",a=0,u=0;u<n;u++){var o=t.pattern.charAt(u);if(l(r,a)){if(!t.showMask&&!f(t.pattern,u))break;i+=o}else i+=h(o)?r.charAt(a++):o}t.value=i}function l(e,t){return t>=e.length||t<0}function h(e){return"_"===e||"0"===e||""===e}function f(e,t){for(;!l(e,t);){var r=e.charAt(t++);if("0"===r)return!0;if("_"===r)return!1}return!1}function c(e){for(var t="",r=e.length;r;)t+=e[--r];return t}n=function(){function e(){var e=t[--r];s(e),e.addEventListener("input",function(){s(e)},!0)}for(var t=o.querySelectorAll("[mask]"),r=t.length;r;)e()},o.addEventListener("DOMContentLoaded",n);var p=(Object.defineProperty(d.prototype,"value",{get:function(){var e=this.removePrefixAndSuffix(this.element.value);return e=this.removeZeros(e.replace(this.deny,"")),this.reverseIfNeeded(e)},set:function(e){var t=this.selection;this.element.value=this.prefix+this.reverseIfNeeded(e)+this.suffix,this.selection=this.calcNewSelection(t)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"elValue",{get:function(){return this.element.value},set:function(e){this.element.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"selection",{get:function(){return this.element.selectionStart},set:function(e){this.element.selectionStart=this.element.selectionEnd=e},enumerable:!0,configurable:!0}),d.prototype.removePrefixAndSuffix=function(e){return e=this.removePrefix(e,this.prefix),e=c(this.removePrefix(c(e),c(this.suffix)))},d.prototype.removePrefix=function(e,t){if(0===e.indexOf(t))return e.substr(t.length);for(var r,n=t.length,i=0,a=0;a<n;a++){var u=t.charAt(a);if(u!==(r=e.charAt(a))){i=u===e.charAt(a+1)?1:-1;break}}var o=a+(1===i?1:0);return-1!==o&&o===e.indexOf(t.substr(a+(1===i?0:1)),o)?(1===i?r:"")+e.substr(t.length+i):e},d.prototype.reverseIfNeeded=function(e){return this.dir!==a.BACKWARD?e:c(e)},d.prototype.removeZeros=function(e){return this.zeroPadEnabled?e.replace(this.dir===a.FORWARD?/0*$/:/^0*/,""):e},d.prototype.calcNewSelection=function(e){if(this.dir===a.BACKWARD)return this.elValue.length-this.suffix.length;var t,r=e-this.prefix.length;for(r<0&&(r=this.keyType===u.VALID?1:0),t=this.keyType===u.INVALID?-1:this.keyType===u.BACKSPACE?-1:1;!h(this.pattern.charAt(r-1));)r+=t;return this.getMaxSelection(r)+this.prefix.length},d.prototype.getMaxSelection=function(e){var t=this.pattern.length,r=this.value.length;if(0===e||0===r)return 0;for(var n=1;n<t;n++)if(h(this.pattern.charAt(n-1))&&(0==--r||e===n))return n;return t},d.prototype.attr=function(e,t){return this.element.getAttribute(e)||t},d.prototype.updateValue=function(){this.lastValue=this.currentValue,this.currentValue=this.value,this.currentValue.length===this.lastValue.length+1?this.keyType=this.deny.test(this.elValue.charAt(this.selection-1))?u.INVALID:u.VALID:this.currentValue.length===this.lastValue.length-1?this.keyType=u.BACKSPACE:this.keyType=u.UNKNOWN,console.log(this.keyType)},d.getAutoMask=function(e){return void 0===e.autoMask?e.autoMask=d.byElement(e):(e.autoMask.updateValue(),e.autoMask)},d.byElement=function(e){var t=new d;t.element=e,t.dir=t.attr(i.DIRECTION,a.FORWARD),t.prefix=t.attr(i.PREFIX,""),t.suffix=t.attr(i.SUFFIX,""),t.pattern=t.reverseIfNeeded(t.attr(i.MASK)),t.showMask="true"===t.attr(i.SHOW_MASK,"").toLowerCase()||!1,t.deny=new RegExp("[^"+t.attr(i.ACCEPT,"\\d")+"]","g"),t.zeroPadEnabled=-1!==t.pattern.indexOf("0"),t.keyType=u.UNKNOWN;for(var r=t.pattern.length,n=t.rawTotalLength=0;n<r;n++)h(t.pattern.charAt(n))&&t.rawTotalLength++;return e.maxLength=t.pattern.length+t.prefix.length+t.suffix.length+1,t.currentValue=t.value,t},d);function d(){}}();