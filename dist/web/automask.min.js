!function(){var i,e,s,t;(e=i=i||{}).FORWARD="forward",e.BACKWARD="backward",(t=s=s||{}).MASK="mask",t.PREFIX="prefix",t.SUFFIX="suffix",t.DIRECTION="dir",t.ACCEPT="accept",t.SHOW_MASK="show-mask";var r,n=document;function a(e){for(var t=l.getAutoMask(e),r=t.getRawValue(),n=t.pattern.length,i="",s=0,a=0;a<n;a++){var u=t.pattern.charAt(a);if(o(r,s)){if(!t.showMask&&!c(t.pattern,a))break;i+=u}else i+=h(u)?r.charAt(s++):u}t.value=i}function o(e,t){return t>=e.length||t<0}function h(e){return"_"===e||("0"===e||""===e)}function c(e,t){for(;!o(e,t);){var r=e.charAt(t++);if("0"===r)return!0;if("_"===r)return!1}return!1}r=function(){function e(){var e=t[--r];a(e),e.addEventListener("input",function(){a(e)},!0)}for(var t=n.querySelectorAll("[mask]"),r=t.length;r;)e()},n.addEventListener("DOMContentLoaded",r);var l=(Object.defineProperty(u.prototype,"value",{set:function(e){var t=this.selection;this.lastValue!==this.currentValue&&(this.element.value=this.prefix+this.reverseIfNeeded(e)+this.suffix,this.selection=this.calcNewSelection(t))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"selection",{get:function(){return this.element.selectionStart},set:function(e){this.element.selectionStart=this.element.selectionEnd=e},enumerable:!0,configurable:!0}),u.prototype.getRawValue=function(){var e=this.removePrefixAndSuffix(this.element.value);return e=(e=this.removeZeros(e.replace(this.deny,""))).substr(0,this.rawTotalLength),this.reverseIfNeeded(e)},u.prototype.isValidKey=function(){return void 0===this.keyPressed||"backspace"===this.keyPressed||!this.deny.test(this.keyPressed)},u.prototype.removePrefixAndSuffix=function(e){return e=this.removeStrOccurences(e,this.prefix,0),e=this.removeStrOccurences(e,this.suffix,e.length-this.suffix.length),console.log(e),e},u.prototype.removeStrOccurences=function(e,t,r){if(e.indexOf(t)===r)return 0===r?e.substr(t.length):e.substring(0,r);var n=t.length,i=r,s=[];0<r&&s.push(e.substring(0,r));for(var a=0;a<n;a++){var u=t.charAt(a),o=r+a;e.charAt(o)===u?i=o+1:e.charAt(o+1)===u?(s.push(e.substring(i,o+1)),i=o+2,r++):r--}return s.push(e.substr(i)),s.join("")},u.prototype.reverseIfNeeded=function(e){if(this.dir!==i.BACKWARD)return e;for(var t="",r=e.length;r;)t+=e[--r];return t},u.prototype.removeZeros=function(e){return this.zeroPadEnabled?e.replace(this.dir===i.FORWARD?/0*$/:/^0*/,""):e},u.prototype.calcNewSelection=function(e){if(this.dir===i.BACKWARD)return this.currentValue.length-this.suffix.length;var t,r=e-this.prefix.length;for(r<1&&(r=this.keyPressed&&"backspace"!==this.keyPressed?1:0),t=this.isValidKey()?"backspace"!==this.keyPressed?1:-1:(r--,-1);!h(this.pattern.charAt(r-1));)r+=t;return this.getMaxSelection(r)+this.prefix.length},u.prototype.getMaxSelection=function(e){var t=this.pattern.length,r=this.getRawValue().length;if(!e||!r)return 0;for(var n=1;n<t;n++)if(h(this.pattern.charAt(n-1))&&(--r<1||n===e))return n;return t},u.getAutoMask=function(e){if(!e.autoMask)return e.autoMask=u.byElement(e);var t=e.autoMask;return t.lastValue=t.currentValue,t.currentValue=t.element.value,t.currentValue.length<t.lastValue.length?t.keyPressed="backspace":t.keyPressed=t.currentValue.charAt(t.selection-1),t},u.byElement=function(e){var t=new u;t.dir=e.getAttribute(s.DIRECTION)||i.FORWARD,t.prefix=e.getAttribute(s.PREFIX)||"",t.suffix=e.getAttribute(s.SUFFIX)||"",t.pattern=t.reverseIfNeeded(e.getAttribute(s.MASK)),t.showMask="true"===(e.getAttribute(s.SHOW_MASK)+"").toLowerCase()||!1,t.deny=new RegExp("[^"+(e.getAttribute(s.ACCEPT)||"\\d")+"]","g"),t.element=e,t.zeroPadEnabled=-1!==t.pattern.indexOf("0");for(var r=t.pattern.length,n=t.rawTotalLength=0;n<r;n++)h(t.pattern.charAt(n))&&t.rawTotalLength++;return t.currentValue=e.value,e.maxLength=t.pattern.length+t.prefix.length+t.suffix.length+1,t},u);function u(){}}();