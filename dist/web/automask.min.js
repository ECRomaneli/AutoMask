!function(){var a,e,i,t,u,r;(e=a=a||{}).MASK="mask",e.PREFIX="prefix",e.SUFFIX="suffix",e.DIRECTION="dir",e.ACCEPT="accept",e.SHOW_MASK="show-mask",(t=i=i||{}).FORWARD="forward",t.BACKWARD="backward",(r=u=u||{}).UNKNOWN="unknown",r.BACKSPACE="backspace",r.INVALID="invalid",r.VALID="valid";var n,o=document;function l(e){for(var t=v.getAutoMask(e),r=t.value,n=t.pattern.length,a="",i=0,u=0;u<n;u++){var o=t.pattern.charAt(u);if(s(r,i)){if(!t.showMask&&!h(t.pattern,u))break;a+=o}else a+=f(o)?r.charAt(i++):o}t.value=a}function s(e,t){return t>=e.length||t<0}function f(e){return"_"===e||"0"===e||""===e}function h(e,t){for(;!s(e,t);){var r=e.charAt(t++);if("0"===r)return!0;if("_"===r)return!1}return!1}function c(e,t){for(var r=0;r<length;r++)if(0===arguments[r])return!0;return!1}function p(e){for(var t="",r=e.length;r;)t+=e[--r];return t}n=function(){function e(){var e=t[--r];l(e),e.addEventListener("input",function(){l(e)},!0)}for(var t=o.querySelectorAll("[mask]"),r=t.length;r;)e()},o.addEventListener("DOMContentLoaded",n);var v=(Object.defineProperty(d.prototype,"value",{get:function(){var e=this.removePrefixAndSuffix(this.element.value);return e=(e=this.removeZeros(e.replace(this.deny,""))).substr(0,this.rawTotalLength),this.reverseIfNeeded(e)},set:function(e){var t=this.selection;this.element.value=this.prefix+this.reverseIfNeeded(e)+this.suffix,this.selection=this.calcNewSelection(t)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"elValue",{get:function(){return this.element.value},set:function(e){this.element.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"selection",{get:function(){return this.element.selectionStart},set:function(e){this.element.selectionStart=this.element.selectionEnd=e},enumerable:!0,configurable:!0}),d.prototype.removePrefixAndSuffix=function(e){return e=this.removePrefix(e,this.prefix),e=p(this.removePrefix(p(e),p(this.suffix)))},d.prototype.removePrefix=function(e,t){if(0===e.indexOf(t))return e.substr(t.length);for(var r,n=t.length,a=0,i=0;i<n;i++){var u=t.charAt(i);if(u!==(r=e.charAt(i))){a=u===e.charAt(i+1)?1:-1;break}}var o=i+a;return-1!==o&&o===e.indexOf(t.substr(i),o)?(1===a?r:"")+e.substr(t.length+a):e},d.prototype.reverseIfNeeded=function(e){return this.dir!==i.BACKWARD?e:p(e)},d.prototype.removeZeros=function(e){return this.zeroPadEnabled?e.replace(this.dir===i.FORWARD?/0*$/:/^0*/,""):e},d.prototype.calcNewSelection=function(e){if(this.dir===i.BACKWARD)return this.currentValue.length-this.suffix.length;var t,r=e-this.prefix.length;for(r<1&&(r=this.keyType===u.BACKSPACE?0:1),t=this.keyType===u.INVALID?(r--,-1):this.keyType===u.BACKSPACE?-1:1;!f(this.pattern.charAt(r-1));)r+=t;return this.getMaxSelection(r)+this.prefix.length},d.prototype.getMaxSelection=function(e){var t=this.pattern.length,r=this.value.length;if(c(e,r))return 0;for(var n=1;n<t;n++)if(f(this.pattern.charAt(n-1))&&(c(--r)||e===n))return n;return t},d.prototype.attr=function(e,t){return this.element.getAttribute(e)||t},d.prototype.updateValue=function(){var e=this.element.autoMask,t=this.element.value.charAt(e.selection-1);e.lastValue=e.currentValue,e.currentValue=this.element.value.replace(this.deny,""),e.currentValue.length===e.lastValue.length+1?e.keyType=e.deny.test(t)?u.INVALID:u.VALID:e.currentValue.length===e.lastValue.length-1?e.keyType=u.BACKSPACE:e.keyType=u.UNKNOWN,console.log(t,e.keyType,this.element.value,e.currentValue)},d.getAutoMask=function(e){return void 0===e.autoMask?e.autoMask=d.byElement(e):(e.autoMask.updateValue(),e.autoMask)},d.byElement=function(e){var t=new d;t.element=e,t.dir=t.attr(a.DIRECTION,i.FORWARD),t.prefix=t.attr(a.PREFIX,""),t.suffix=t.attr(a.SUFFIX,""),t.pattern=t.reverseIfNeeded(t.attr(a.MASK)),t.showMask="true"===t.attr(a.SHOW_MASK,"").toLowerCase()||!1,t.deny=new RegExp("[^"+t.attr(a.ACCEPT,"\\d")+"]","g"),t.zeroPadEnabled=-1!==t.pattern.indexOf("0"),t.keyType=u.UNKNOWN;for(var r=t.pattern.length,n=t.rawTotalLength=0;n<r;n++)f(t.pattern.charAt(n))&&t.rawTotalLength++;return t.currentValue=e.value.replace(t.deny,""),e.maxLength=t.pattern.length+t.prefix.length+t.suffix.length+1,t},d);function d(){}}();